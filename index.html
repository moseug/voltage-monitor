<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–õ–ê–í–ê –ø–æ–¥ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ–º</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container { max-width: 1400px; margin: 0 auto; }

        .header { text-align: center; color: white; margin-bottom: 30px; }
        .header h1 { font-size: 2.5em; font-weight: 300; margin-bottom: 10px; }
        .header p { font-size: 1.1em; opacity: 0.9; }

        .last-update {
            text-align: center; color: white;
            margin-bottom: 20px; font-size: 0.9em; opacity: 0.8;
        }

        .cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: white; border-radius: 16px; padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }
        .card:hover { transform: translateY(-5px); }

        .card-title { font-size: 0.9em; color: #666; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 15px; }

        .voltage-value { font-size: 3em; font-weight: 700; color: #667eea; margin-bottom: 10px; }
        .voltage-unit { font-size: 0.4em; color: #999; margin-left: 5px; }

        .status {
            display: inline-block; padding: 5px 15px;
            border-radius: 20px; font-size: 0.85em; font-weight: 600;
        }
        .status.normal { background: #d4edda; color: #155724; }
        .status.warning { background: #fff3cd; color: #856404; }
        .status.danger { background: #f8d7da; color: #721c24; }

        .chart-container {
            background: white; border-radius: 16px; padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); margin-bottom: 30px;
        }

        .chart-controls {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 20px; flex-wrap: wrap; gap: 15px;
        }

        .chart-title { font-size: 1.5em; font-weight: 600; color: #333; }
        .period-selector { display: flex; gap: 10px; }

        .period-btn {
            padding: 8px 20px; border: 2px solid #667eea; background: white;
            color: #667eea; border-radius: 8px; cursor: pointer;
            font-weight: 600; transition: all 0.3s ease;
        }
        .period-btn:hover, .period-btn.active { background: #667eea; color: white; }

        .export-btn {
            padding: 10px 25px; background: #28a745; color: white;
            border: none; border-radius: 8px; cursor: pointer;
            font-weight: 600; font-size: 1em; transition: all 0.3s ease;
            display: inline-flex; align-items: center; gap: 8px;
        }
        .export-btn:hover {
            background: #218838; transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        .info-section {
            background: white; border-radius: 16px; padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .info-title { font-size: 1.5em; font-weight: 600; color: #333; margin-bottom: 20px; }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }

        .info-item {
            padding: 15px; background: #f8f9fa;
            border-radius: 8px; border-left: 4px solid #667eea;
        }
        .info-item h4 { color: #667eea; margin-bottom: 10px; }
        .info-item p { color: #666; line-height: 1.6; }

        .compliance {
            margin-top: 20px; padding: 20px;
            background: #e8f4f8; border-radius: 8px; border-left: 4px solid #17a2b8;
        }
        .compliance h4 { color: #17a2b8; margin-bottom: 15px; }

        .error { background: #f8d7da; color: #721c24; padding: 15px; border-radius: 8px; margin-bottom: 20px; }

        @media (max-width: 768px) {
            .header h1 { font-size: 1.8em; }
            .voltage-value { font-size: 2.5em; }
            .chart-controls { flex-direction: column; align-items: stretch; }
            .period-selector { flex-wrap: wrap; }
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>‚ö° –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è —ç–ª–µ–∫—Ç—Ä–æ—Å–µ—Ç–∏</h1>
        <p>–¢—Ä–µ—Ö—Ñ–∞–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ ¬∑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç</p>
    </div>

    <div class="last-update" id="last-update">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
    <div id="error-container"></div>

    <div class="cards">
        <div class="card">
            <div class="card-title">–§–∞–∑–∞ A</div>
            <div class="voltage-value" id="phase-a">‚Äî<span class="voltage-unit">–í</span></div>
            <span class="status" id="status-a">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
        <div class="card">
            <div class="card-title">–§–∞–∑–∞ B</div>
            <div class="voltage-value" id="phase-b">‚Äî<span class="voltage-unit">–í</span></div>
            <span class="status" id="status-b">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
        <div class="card">
            <div class="card-title">–§–∞–∑–∞ C</div>
            <div class="voltage-value" id="phase-c">‚Äî<span class="voltage-unit">–í</span></div>
            <span class="status" id="status-c">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
    </div>

    <div class="chart-container">
        <div class="chart-controls">
            <h3 class="chart-title">–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è</h3>
            <div class="period-selector">
                <button class="period-btn" onclick="changePeriod(1, this)">1 —á–∞—Å</button>
                <button class="period-btn" onclick="changePeriod(6, this)">6 —á–∞—Å–æ–≤</button>
                <button class="period-btn active" onclick="changePeriod(24, this)">24 —á–∞—Å–∞</button>
                <button class="period-btn" onclick="changePeriod(168, this)">7 –¥–Ω–µ–π</button>
            </div>
        </div>
        <canvas id="voltageChart"></canvas>
        <div style="text-align: center; margin-top: 20px;">
            <button class="export-btn" onclick="exportToExcel()">
                <span>üìä</span> –í—ã–≥—Ä—É–∑–∏—Ç—å –≤ Excel
            </button>
        </div>
    </div>

    <div class="info-section">
        <h3 class="info-title">üìã –ù–æ—Ä–º—ã —ç–ª–µ–∫—Ç—Ä–æ—Å–Ω–∞–±–∂–µ–Ω–∏—è –≤ –†–æ—Å—Å–∏–∏</h3>

        <div class="info-grid">
            <div class="info-item">
                <h4>–ù–æ–º–∏–Ω–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ</h4>
                <p><strong>220 –í (230 –í –ø–æ –ì–û–°–¢ 29322-2014)</strong><br>
                –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –æ–¥–Ω–æ—Ñ–∞–∑–Ω–æ–π —Å–µ—Ç–∏ –≤ –†–æ—Å—Å–∏–∏ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 220 –í, –æ–¥–Ω–∞–∫–æ —Å–æ–≥–ª–∞—Å–Ω–æ –ì–û–°–¢ 29322-2014 –Ω–æ–º–∏–Ω–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∫–∞–∫ 230 –í –¥–ª—è –≥–∞—Ä–º–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å –µ–≤—Ä–æ–ø–µ–π—Å–∫–∏–º–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º–∏.</p>
            </div>
            <div class="info-item">
                <h4>–î–æ–ø—É—Å—Ç–∏–º—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è</h4>
                <p><strong>¬±10% (207‚Äì253 –í)</strong><br>
                –°–æ–≥–ª–∞—Å–Ω–æ –ì–û–°–¢ 29322-2014, –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç ¬±10% –æ—Ç –Ω–æ–º–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è 230 –í, —Ç–æ –µ—Å—Ç—å –æ—Ç 207 –¥–æ 253 –í.</p>
            </div>
            <div class="info-item">
                <h4>–ü—Ä–µ–¥–µ–ª—å–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è</h4>
                <p><strong>¬±15% (195.5‚Äì264.5 –í)</strong><br>
                –ü—Ä–µ–¥–µ–ª—å–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç ¬±15% –æ—Ç –Ω–æ–º–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è. –í—ã—Ö–æ–¥ –∑–∞ —ç—Ç–∏ –ø—Ä–µ–¥–µ–ª—ã —è–≤–ª—è–µ—Ç—Å—è –≥—Ä—É–±—ã–º –Ω–∞—Ä—É—à–µ–Ω–∏–µ–º –∫–∞—á–µ—Å—Ç–≤–∞ —ç–ª–µ–∫—Ç—Ä–æ—Å–Ω–∞–±–∂–µ–Ω–∏—è.</p>
            </div>
            <div class="info-item">
                <h4>–î–æ–ø—É—Å—Ç–∏–º–æ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è</h4>
                <p><strong>–î–æ 72 —á–∞—Å–æ–≤ –≤ –≥–æ–¥</strong><br>
                –°–æ–≥–ª–∞—Å–Ω–æ –ü–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é –ü—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–∞ –†–§ ‚Ññ354, —Å—É–º–º–∞—Ä–Ω–∞—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ä—ã–≤–æ–≤ —ç–ª–µ–∫—Ç—Ä–æ—Å–Ω–∞–±–∂–µ–Ω–∏—è –Ω–µ –¥–æ–ª–∂–Ω–∞ –ø—Ä–µ–≤—ã—à–∞—Ç—å 72 —á–∞—Å–∞ –≤ –≥–æ–¥ (–¥–ª—è –Ω–∞—Å–µ–ª–µ–Ω–∏—è).</p>
            </div>
            <div class="info-item">
                <h4>–ß–∞—Å—Ç–æ—Ç–∞ —Å–µ—Ç–∏</h4>
                <p><strong>50 –ì—Ü ¬±0.2 –ì—Ü</strong><br>
                –ù–æ–º–∏–Ω–∞–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–æ–π —Å–µ—Ç–∏ –≤ –†–æ—Å—Å–∏–∏ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 50 –ì—Ü —Å –¥–æ–ø—É—Å—Ç–∏–º—ã–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ–º ¬±0.2 –ì—Ü –≤ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ —Ä–∞–±–æ—Ç—ã.</p>
            </div>
            <div class="info-item">
                <h4>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏</h4>
                <p><strong>I, II, III –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</strong><br>
                I –∫–∞—Ç–µ–≥–æ—Ä–∏—è ‚Äî –ø–µ—Ä–µ—Ä—ã–≤ —Ç–æ–ª—å–∫–æ –Ω–∞ –≤—Ä–µ–º—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è (—Å–µ–∫). II –∫–∞—Ç–µ–≥–æ—Ä–∏—è ‚Äî –¥–æ 2 —á–∞—Å–æ–≤. III –∫–∞—Ç–µ–≥–æ—Ä–∏—è ‚Äî –¥–æ 24 —á–∞—Å–æ–≤.</p>
            </div>
        </div>

        <div class="compliance">
            <h4>üîç –û—Ü–µ–Ω–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –Ω–æ—Ä–º–∞–º</h4>
            <div id="compliance-info"><p>–û–∂–∏–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è...</p></div>
        </div>
    </div>
</div>

<script>
    let voltageHistory = [];
    let currentPeriod = 24;
    let chart = null;

    function initChart() {
        const ctx = document.getElementById('voltageChart').getContext('2d');
        chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [
                    {
                        label: '–§–∞–∑–∞ A',
                        data: [],
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        borderWidth: 2
                    },
                    {
                        label: '–§–∞–∑–∞ B',
                        data: [],
                        borderColor: '#f093fb',
                        backgroundColor: 'rgba(240, 147, 251, 0.1)',
                        tension: 0.4,
                        borderWidth: 2
                    },
                    {
                        label: '–§–∞–∑–∞ C',
                        data: [],
                        borderColor: '#4facfe',
                        backgroundColor: 'rgba(79, 172, 254, 0.1)',
                        tension: 0.4,
                        borderWidth: 2
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                aspectRatio: 2.5,
                plugins: {
                    legend: { position: 'top', labels: { usePointStyle: true, padding: 15 } },
                    tooltip: { mode: 'index', intersect: false }
                },
                scales: {
                    y: {
                        beginAtZero: false,
                        // –†–∞—Å—à–∏—Ä–µ–Ω –¥–∏–∞–ø–∞–∑–æ–Ω –¥–æ –ø—Ä–µ–¥–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ –ì–û–°–¢
                        min: 190,
                        max: 270,
                        grid: { color: 'rgba(0, 0, 0, 0.05)' },
                        ticks: { callback: v => v + ' –í' }
                    },
                    x: { grid: { color: 'rgba(0, 0, 0, 0.05)' } }
                }
            }
        });
    }

    async function loadData() {
        try {
            const latestResponse = await fetch('data/latest.json');
            if (!latestResponse.ok) throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å latest.json');
            const latest = await latestResponse.json();

            updateDisplay(latest);
            updateCompliance(latest);

            const updateTime = new Date(latest.timestamp);
            document.getElementById('last-update').textContent =
                `–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: ${updateTime.toLocaleString('ru-RU')}`;

            const historyResponse = await fetch('data/voltage-history.json');
            if (!historyResponse.ok) throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å voltage-history.json');
            voltageHistory = await historyResponse.json();

            updateChart();
            clearError();

        } catch (error) {
            showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: ' + error.message);
            console.error('Error:', error);
        }
    }

    function updateDisplay(voltages) {
        document.getElementById('phase-a').innerHTML =
            `${voltages.phaseA.toFixed(1)}<span class="voltage-unit">–í</span>`;
        document.getElementById('phase-b').innerHTML =
            `${voltages.phaseB.toFixed(1)}<span class="voltage-unit">–í</span>`;
        document.getElementById('phase-c').innerHTML =
            `${voltages.phaseC.toFixed(1)}<span class="voltage-unit">–í</span>`;

        updateStatus('status-a', voltages.phaseA);
        updateStatus('status-b', voltages.phaseB);
        updateStatus('status-c', voltages.phaseC);
    }

    function updateStatus(elementId, voltage) {
        const el = document.getElementById(elementId);
        el.className = 'status';
        if (voltage >= 207 && voltage <= 253) {
            el.classList.add('normal');
            el.textContent = '–ù–æ—Ä–º–∞';
        } else if (voltage >= 195.5 && voltage <= 264.5) {
            el.classList.add('warning');
            el.textContent = '–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ';
        } else {
            el.classList.add('danger');
            el.textContent = '–û–ø–∞—Å–Ω–æ!';
        }
    }

    function updateChart() {
        const cutoff = new Date(Date.now() - currentPeriod * 3600 * 1000);
        const filtered = voltageHistory.reduce((acc, r) => {
            if (new Date(r.timestamp) >= cutoff) {
                acc.labels.push(formatTime(new Date(r.timestamp)));
                acc.phaseA.push(r.phaseA);
                acc.phaseB.push(r.phaseB);
                acc.phaseC.push(r.phaseC);
            }
            return acc;
        }, { labels: [], phaseA: [], phaseB: [], phaseC: [] });

        chart.data.labels = filtered.labels;
        chart.data.datasets[0].data = filtered.phaseA;
        chart.data.datasets[1].data = filtered.phaseB;
        chart.data.datasets[2].data = filtered.phaseC;
        chart.update();
    }

    function formatTime(date) {
        const opts = { hour: '2-digit', minute: '2-digit' };
        if (currentPeriod > 24) { opts.day = '2-digit'; opts.month = '2-digit'; }
        return date.toLocaleTimeString('ru-RU', opts);
    }

    // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –±–∞–≥: –∫–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —è–≤–Ω–æ, –Ω–µ —á–µ—Ä–µ–∑ –≥–ª–æ–±–∞–ª—å–Ω—ã–π event
    function changePeriod(hours, btn) {
        currentPeriod = hours;
        document.querySelectorAll('.period-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        updateChart();
    }

    function exportToExcel() {
        const wb = XLSX.utils.book_new();
        const data = [['–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è', '–§–∞–∑–∞ A (–í)', '–§–∞–∑–∞ B (–í)', '–§–∞–∑–∞ C (–í)']];

        voltageHistory.forEach(r => {
            data.push([
                new Date(r.timestamp).toLocaleString('ru-RU'),
                // –ß–∏—Å–ª–∞, –∞ –Ω–µ —Å—Ç—Ä–æ–∫–∏ ‚Äî –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Ñ–æ—Ä–º—É–ª –≤ Excel
                parseFloat(r.phaseA.toFixed(2)),
                parseFloat(r.phaseB.toFixed(2)),
                parseFloat(r.phaseC.toFixed(2))
            ]);
        });

        const ws = XLSX.utils.aoa_to_sheet(data);
        XLSX.utils.book_append_sheet(wb, ws, '–ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ');
        XLSX.writeFile(wb, `voltage_data_${new Date().toISOString().split('T')[0]}.xlsx`);
    }

    function updateCompliance(voltages) {
        const phases = [
            { name: 'A', value: voltages.phaseA },
            { name: 'B', value: voltages.phaseB },
            { name: 'C', value: voltages.phaseC }
        ];

        let html = '<ul style="list-style: none; padding: 0;">';
        phases.forEach(({ name, value }) => {
            let status, icon;
            if (value >= 207 && value <= 253) {
                status = '<span style="color:#155724;font-weight:600;">‚úì –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–æ—Ä–º–µ</span>';
                icon = '‚úÖ';
            } else if (value >= 195.5 && value <= 264.5) {
                status = '<span style="color:#856404;font-weight:600;">‚ö† –ü—Ä–µ–¥–µ–ª—å–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ</span>';
                icon = '‚ö†Ô∏è';
            } else {
                status = '<span style="color:#721c24;font-weight:600;">‚úó –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –Ω–æ—Ä–º—ã!</span>';
                icon = '‚ùå';
            }
            html += `<li style="padding:8px 0;border-bottom:1px solid #ddd;">
                ${icon} <strong>–§–∞–∑–∞ ${name}:</strong> ${value.toFixed(1)} –í ‚Äî ${status}
            </li>`;
        });
        html += '</ul>';

        const avg = (voltages.phaseA + voltages.phaseB + voltages.phaseC) / 3;
        html += `<p style="margin-top:15px;font-weight:600;">–°—Ä–µ–¥–Ω–µ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ: ${avg.toFixed(1)} –í</p>`;

        document.getElementById('compliance-info').innerHTML = html;
    }

    function showError(msg) {
        document.getElementById('error-container').innerHTML =
            `<div class="error">‚ö†Ô∏è ${msg}</div>`;
    }

    function clearError() {
        document.getElementById('error-container').innerHTML = '';
    }

    document.addEventListener('DOMContentLoaded', () => {
        initChart();
        loadData();
        // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
        setInterval(loadData, 5 * 60 * 1000);
    });
</script>
</body>
</html>
